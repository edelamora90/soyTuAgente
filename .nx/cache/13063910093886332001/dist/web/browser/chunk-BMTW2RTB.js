import{a as N}from"./chunk-2IOX6WI7.js";import"./chunk-RPALSS5Z.js";import{a as B,b as A}from"./chunk-UDWRQ6PZ.js";import{$a as n,Db as I,Ka as v,Oa as h,Sb as T,Tb as L,U as S,Ub as D,Wb as V,Z as p,Za as d,_ as g,_a as o,ab as P,eb as O,fb as y,gb as C,ha as u,hb as m,jb as _,nb as b,pb as M,qb as r,rb as f,wb as w,xb as E,za as a,zb as k}from"./chunk-A5EMK4AJ.js";function F(s,t){if(s&1&&(o(0,"div",18),r(1),n()),s&2){let e=_();a(),f(e.errorMsg())}}function q(s,t){s&1&&(o(0,"div",19),r(1,"Cargando..."),n())}function R(s,t){if(s&1){let e=C();o(0,"tr")(1,"td"),r(2),n(),o(3,"td")(4,"code"),r(5),n()(),o(6,"td"),r(7),n(),o(8,"td"),r(9),n(),o(10,"td"),r(11),n(),o(12,"td"),r(13),w(14,"date"),n(),o(15,"td",22)(16,"button",23),m("click",function(){let l=p(e).$implicit,c=_(2),x=b(19);return g(c.open(l,x))}),r(17,"Ver"),n()()()}if(s&2){let e=t.$implicit;a(2),f(e.nombre),a(3),f(e.slug),a(2),f(e.ubicacion||"\u2014"),a(2),f(e.whatsapp||"\u2014"),a(2),f((e.especialidades==null?null:e.especialidades.join(", "))||"\u2014"),a(2),f(E(14,6,e.createdAt,"short"))}}function z(s,t){if(s&1&&(o(0,"table",20)(1,"thead")(2,"tr")(3,"th"),r(4,"Nombre"),n(),o(5,"th"),r(6,"Slug"),n(),o(7,"th"),r(8,"Ubicaci\xF3n"),n(),o(9,"th"),r(10,"WhatsApp"),n(),o(11,"th"),r(12,"Especialidades"),n(),o(13,"th"),r(14,"Creado"),n(),P(15,"th"),n()(),o(16,"tbody"),h(17,R,18,9,"tr",21),n()()),s&2){let e=_();a(17),d("ngForOf",e.filtered())("ngForTrackBy",e.trackById)}}function H(s,t){s&1&&(o(0,"p",24),r(1,"No hay resultados."),n())}function G(s,t){if(s&1&&(O(0),P(1,"app-agent-profile-presenter",25),y()),s&2){let e=t.ngIf;a(),d("agent",e)}}function J(s,t){s&1&&(o(0,"div",26),r(1,"Cargando\u2026"),n())}function U(s,t){if(s&1){let e=C();o(0,"footer",27)(1,"button",28),m("click",function(){p(e);let l=_(),c=b(19);return g(l.reject(c))}),r(2,"Rechazar"),n(),o(3,"button",29),m("click",function(){p(e);let l=_(),c=b(19);return g(l.approve(c))}),r(4,"Aprobar"),n()()}if(s&2){let e=_();a(),d("disabled",e.actionBusy()),a(2),d("disabled",e.actionBusy())}}var j=class s{api=S(N);loading=u(!0);actionBusy=u(!1);errorMsg=u(null);rows=u([]);selected=u(null);vm=u(null);status=u("PENDING");q=u("");filtered=I(()=>{let t=this.q().trim().toLowerCase(),e=this.rows();return t?e.filter(i=>(i.nombre||"").toLowerCase().includes(t)||(i.slug||"").toLowerCase().includes(t)):e});ngOnInit(){this.load()}load(){this.loading.set(!0),this.errorMsg.set(null),this.api.list(this.status()).subscribe({next:t=>{this.rows.set(t??[]),this.loading.set(!1)},error:t=>{this.errorMsg.set(t?.error?.message??"Error al cargar solicitudes."),this.loading.set(!1)}})}setStatus(t){this.status()!==t&&(this.status.set(t),this.q.set(""),this.load())}open(t,e){this.selected.set(t),this.vm.set(A(t)),e.showModal()}close(t){t.close(),this.selected.set(null),this.vm.set(null)}approve(t){let e=this.selected();e&&(this.actionBusy.set(!0),this.api.approve(e.id).subscribe({next:i=>{this.actionBusy.set(!1),this.close(t),this.load()},error:i=>{this.actionBusy.set(!1),this.errorMsg.set(i?.error?.message??"Error al aprobar.")}}))}reject(t){let e=this.selected();if(!e)return;let i=prompt("Motivo del rechazo (opcional):")??void 0;this.actionBusy.set(!0),this.api.reject(e.id,i).subscribe({next:l=>{this.actionBusy.set(!1),this.close(t),this.load()},error:l=>{this.actionBusy.set(!1),this.errorMsg.set(l?.error?.message??"Error al rechazar.")}})}trackById=(t,e)=>e.id;static \u0275fac=function(e){return new(e||s)};static \u0275cmp=v({type:s,selectors:[["app-solicitudes-list"]],decls:29,vars:14,consts:[["qBox",""],["dlg",""],["skeleton",""],[1,"wrap"],[1,"head"],[1,"tabs"],[3,"click"],[1,"toolbar"],["type","search","placeholder","Buscar por nombre o slug...",3,"input","value"],["class","msg error",4,"ngIf"],["class","loading",4,"ngIf"],["class","table",4,"ngIf"],["class","empty",4,"ngIf"],[1,"profile-dialog"],[1,"modal-head"],[1,"close",3,"click"],[4,"ngIf","ngIfElse"],["class","actions",4,"ngIf"],[1,"msg","error"],[1,"loading"],[1,"table"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-actions"],[1,"btn","btn-ghost",3,"click"],[1,"empty"],[3,"agent"],[2,"padding","16px"],[1,"actions"],[1,"reject",3,"click","disabled"],[1,"approve",3,"click","disabled"]],template:function(e,i){if(e&1){let l=C();o(0,"section",3)(1,"header",4)(2,"h1"),r(3,"Solicitudes de Agente"),n(),o(4,"nav",5)(5,"button",6),m("click",function(){return p(l),g(i.setStatus("PENDING"))}),r(6,"Pendientes"),n(),o(7,"button",6),m("click",function(){return p(l),g(i.setStatus("APPROVED"))}),r(8,"Aprobadas"),n(),o(9,"button",6),m("click",function(){return p(l),g(i.setStatus("REJECTED"))}),r(10,"Rechazadas"),n()()(),o(11,"div",7)(12,"input",8,0),m("input",function(){p(l);let x=b(13);return g(i.q.set(x.value))}),n()(),h(14,F,2,1,"div",9)(15,q,2,0,"div",10)(16,z,18,2,"table",11)(17,H,2,0,"p",12),o(18,"dialog",13,1)(20,"header",14)(21,"h2"),r(22,"Detalle de solicitud"),n(),o(23,"button",15),m("click",function(){p(l);let x=b(19);return g(i.close(x))}),r(24,"\u2715"),n()(),h(25,G,2,1,"ng-container",16)(26,J,2,0,"ng-template",null,2,k)(28,U,5,2,"footer",17),n()()}if(e&2){let l=b(27);a(5),M("active",i.status()==="PENDING"),a(2),M("active",i.status()==="APPROVED"),a(2),M("active",i.status()==="REJECTED"),a(3),d("value",i.q()),a(2),d("ngIf",i.errorMsg()),a(),d("ngIf",i.loading()),a(),d("ngIf",!i.loading()&&i.filtered().length),a(),d("ngIf",!i.loading()&&!i.filtered().length),a(8),d("ngIf",i.vm())("ngIfElse",l),a(3),d("ngIf",i.selected())}},dependencies:[V,T,L,B,D],styles:['@charset "UTF-8";.wrap[_ngcontent-%COMP%]{max-width:1100px;margin:24px auto;padding:0 16px}.head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px}.tabs[_ngcontent-%COMP%]{display:flex;gap:8px}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #ddd;background:#fff;padding:8px 12px;border-radius:10px;cursor:pointer}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#1a73e8;color:#fff;border-color:#1a73e8}.toolbar[_ngcontent-%COMP%]{margin:12px 0;display:flex;gap:12px;align-items:center}.toolbar[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]{flex:1;padding:10px 12px;border:1px solid #ddd;border-radius:10px}.refresh[_ngcontent-%COMP%]{border:1px solid #ddd;background:#fff;padding:8px 12px;border-radius:10px;cursor:pointer}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #eee;padding:10px;text-align:left}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700}code[_ngcontent-%COMP%]{background:#f3f3f3;padding:2px 6px;border-radius:6px}.loading[_ngcontent-%COMP%]{padding:12px}.empty[_ngcontent-%COMP%]{color:#666;padding:12px 0}.msg.error[_ngcontent-%COMP%]{color:#c62828;margin:12px 0}article[_ngcontent-%COMP%]{padding:16px}.modal-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.close[_ngcontent-%COMP%]{background:transparent;color:#333;border:none;font-size:20px;cursor:pointer}.grid[_ngcontent-%COMP%]{margin-top:8px;display:grid;gap:12px;grid-template-columns:repeat(2,minmax(0,1fr))}.field.col-2[_ngcontent-%COMP%]{grid-column:span 2}pre[_ngcontent-%COMP%]{background:#f7f7f7;padding:8px;border-radius:10px;white-space:pre-wrap}.thumbs[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.thumbs[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px;height:80px;object-fit:cover;border-radius:10px;border:1px solid #eee}.actions[_ngcontent-%COMP%]{margin-top:16px;display:flex;justify-content:flex-end;gap:12px}.actions[_ngcontent-%COMP%]   .approve[_ngcontent-%COMP%]{background:#0a8f47;color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}.actions[_ngcontent-%COMP%]   .reject[_ngcontent-%COMP%]{background:#c62828;color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}.actions[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}dialog.profile-dialog[_ngcontent-%COMP%]{width:min(980px,96vw);border:0;border-radius:16px;padding:0}dialog.profile-dialog[_ngcontent-%COMP%]::backdrop{background:#0006}.modal-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #eef2f7}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end;padding:12px 16px;border-top:1px solid #eef2f7}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;height:34px;padding:0 12px;border-radius:999px;font-weight:600;font-size:14px;line-height:1;cursor:pointer;border:1px solid transparent;transition:background .15s ease,border-color .15s ease,transform .12s ease;-webkit-user-select:none;user-select:none;text-decoration:none}.btn-ghost[_ngcontent-%COMP%]{background:#fff;color:#0b2f34;border-color:#d0d5dd;box-shadow:0 1px 2px #1018280d}.btn-ghost[_ngcontent-%COMP%]:hover{background:#c8f5e6;border-color:#c5cdd6;transform:translateY(-1px)}.table[_ngcontent-%COMP%]   td.col-actions[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:right;white-space:nowrap}']})};export{j as SolicitudesListComponent};
