<!-- web/src/app/pages/blog-list/blog-list.component.html -->
<section class="blog-page">
  <div class="wrap">

    <!-- TÍTULO DE PÁGINA -->
    <section class="list-section list-section--top">
      <header class="list-head">
        <h2 class="page-title">
          Artículos y <span class="grad">recursos</span> para agentes
        </h2>
        <p class="page-sub">
          Explora las últimas publicaciones de Soy tu Agente: herramientas,
          tácticas y buenas prácticas para tu día a día.
        </p>
      </header>
    </section>

    <!-- HERO DESTACADO -->
    <section class="hero" *ngIf="featuredPost$ | async as featured">
      <div class="hero-card">
        <div class="hero-grid">
          <!-- Columna izquierda: texto completo (título + contenido) -->
          <div class="hero-text">
            <h1 class="hero-title">
              {{ featured.title }}
            </h1>

            <p class="eyebrow">Blog para agentes de seguros</p>

            <p class="hero-meta">
              <span *ngIf="featured.tag" class="pill">
                {{ featured.tag }}
              </span>
              <span *ngIf="featured.readMinutes">
                {{ featured.readMinutes }} min de lectura
              </span>
              <span
                class="dot"
                *ngIf="featured.readMinutes && featured.topic"
              ></span>
              <span *ngIf="featured.topic">
                {{ featured.topic }}
              </span>
            </p>

            <p class="hero-excerpt">
              {{ getHeroSubtitle(featured) }}
            </p>

            <div class="hero-actions">
              <a
                class="btn btn-primary"
                [routerLink]="['/blog', featured.slug]"
              >
                Leer artículo destacado
              </a>
            </div>
          </div>

          <!-- Columna derecha: imagen -->
          <div class="hero-media">
            <img
              [src]="getCoverUrl(featured)"
              [alt]="featured.title"
              (error)="onImgError($event)"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- LISTA 3xN -->
    <section class="list-section" *ngIf="otherPosts$ | async as posts; else sk">
      <div class="posts-grid" *ngIf="posts.length; else empty">
        <article
          class="post-card"
          *ngFor="let p of posts; trackBy: trackById"
          itemscope
          itemtype="https://schema.org/BlogPosting"
        >
          <div class="post-media">
            <img
              [src]="getCoverUrl(p)"
              [alt]="p.title"
              itemprop="image"
              (error)="onImgError($event)"
            />
          </div>

          <div class="post-body">
            <div class="post-top">
              <span
                class="pill pill-soft"
                *ngIf="p.tag"
                itemprop="articleSection"
              >
                {{ p.tag }}
              </span>
            </div>

            <h3 class="post-title" itemprop="headline">
              <a *ngIf="!p.externalUrl" [routerLink]="['/blog', p.slug]">
                {{ p.title }}
              </a>
              <a
                *ngIf="p.externalUrl"
                [href]="p.externalUrl"
                target="_blank"
                rel="noopener"
              >
                {{ p.title }}
              </a>
            </h3>

            <p class="post-meta">
              <span *ngIf="p.readMinutes">{{ p.readMinutes }} min</span>
              <span class="dot" *ngIf="p.readMinutes && p.topic"></span>
              <span *ngIf="p.topic">{{ p.topic }}</span>
              <time
                class="date"
                *ngIf="p.publishedAt"
                [attr.datetime]="p.publishedAt"
                itemprop="datePublished"
              >
                · {{ p.publishedAt | date: 'd MMM y' }}
              </time>
            </p>

            <div class="post-actions">
              <a
                class="btn btn-ghost"
                *ngIf="!p.externalUrl"
                [routerLink]="['/blog', p.slug]"
              >
                Leer más
              </a>
              <a
                class="btn btn-ghost"
                *ngIf="p.externalUrl"
                [href]="p.externalUrl"
                target="_blank"
                rel="noopener"
              >
                Ver publicación
              </a>
            </div>
          </div>
        </article>
      </div>

      <ng-template #empty>
        <p class="empty">
          Aún no hay más artículos publicados.
        </p>
      </ng-template>
    </section>

    <!-- SKELETON -->
    <ng-template #sk>
      <section class="list-section">
        <div class="posts-grid skeleton-grid">
          <article class="skeleton-card"></article>
          <article class="skeleton-card"></article>
          <article class="skeleton-card"></article>
        </div>
      </section>
    </ng-template>
  </div>
</section>
