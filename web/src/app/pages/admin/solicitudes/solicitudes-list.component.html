<section class="wrap">
  <header class="head">
    <h1>Solicitudes de Agente</h1>

    <nav class="tabs">
      <button [class.active]="status()==='PENDING'"  (click)="setStatus('PENDING')">Pendientes</button>
      <button [class.active]="status()==='APPROVED'" (click)="setStatus('APPROVED')">Aprobadas</button>
      <button [class.active]="status()==='REJECTED'" (click)="setStatus('REJECTED')">Rechazadas</button>
    </nav>
  </header>

  <div class="toolbar">
    <input
  #qBox
  type="search"
  placeholder="Buscar por nombre o slug..."
  [value]="q()"
  (input)="q.set(qBox.value)"
/>
  </div>

  <div class="msg error" *ngIf="errorMsg()">{{ errorMsg() }}</div>
  <div *ngIf="loading()" class="loading">Cargando...</div>

  <table class="table" *ngIf="!loading() && filtered().length">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Slug</th>
        <th>Ubicación</th>
        <th>WhatsApp</th>
        <th>Especialidades</th>
        <th>Creado</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of filtered(); trackBy: trackById">
        <td>{{ r.nombre }}</td>
        <td><code>{{ r.slug }}</code></td>
        <td>{{ r.ubicacion || '—' }}</td>
        <td>{{ r.whatsapp || '—' }}</td>
        <td>{{ r.especialidades?.join(', ') || '—' }}</td>
        <td>{{ r.createdAt | date:'short' }}</td>
        <td class="col-actions"><button class="btn btn-ghost" (click)="open(r, dlg)">Ver</button></td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="!loading() && !filtered().length" class="empty">No hay resultados.</p>

  <!-- Modal Detalle -->
  <!-- ...tu tabla queda igual... -->

<!-- Modal Detalle (usa el presenter del perfil) -->
<dialog #dlg class="profile-dialog">
  <header class="modal-head">
    <h2>Detalle de solicitud</h2>
    <button class="close" (click)="close(dlg)">✕</button>
  </header>

  <!-- Presenter del perfil -->
  <ng-container *ngIf="vm() as data; else skeleton">
  <app-agent-profile-presenter [agent]="data"></app-agent-profile-presenter>
</ng-container>

  <ng-template #skeleton>
    <div style="padding:16px">Cargando…</div>
  </ng-template>

  <footer class="actions" *ngIf="selected()">
    <button class="reject" [disabled]="actionBusy()" (click)="reject(dlg)">Rechazar</button>
    <button class="approve" [disabled]="actionBusy()" (click)="approve(dlg)">Aprobar</button>
  </footer>
</dialog>
</section>
